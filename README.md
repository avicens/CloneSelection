# Pan-cancer analysis of selection
In this project, I conducted a Pan-Cancer analysis to examine selection during clonal evolution. 

## Repository content
The repository contains the scripts written to perform the computational workflow of this study, as well as some example files required as input in some steps.

The scripts were written to upload jobs to a SLURM-based scheduling system (CESGA FinisTerrae II). The scripts whose filename end with *array.sh* call to launch multiple jobs with the same parameters. The scripts whose filename end with *parallel.sh* run  parrallel jobs as a single task using GNU parallel.

## Cancer genomic data
I used meta-cancer data of [PanCanAtlas](https://gdc.cancer.gov/about-data/publications/pancanatlas). This project assemble information from 10,824 tumor samples across 33 cancer types from the Cancer Genome Atlas (TCGA) (Study Accession: phs000178.v10.p8).

Somatic mutations for each tumor sample were obtained from the metafile **mc3.v0.2.8.PUBLIC.maf.gz** available in PanCanAtlas. This metafile was generated by the Multi-Center Mutation Calling in Multiple Cancers project [MC3](https://www.sciencedirect.com/science/article/pii/S2405471218300966?via%3Dihub). For extracting mutations per tumor sample, I used the wrapper script **Wrapper_SNV_TCGA.py**, which calls the script **Obtain_SNV_TCGA.py**. 

I obtained copy number state, ploidy and purity information for 9786 tumor samples from a metafile (**TCGA_mastercalls.abs_segtabs.fixed.txt**) computed by [ABSOLUTE](https://software.broadinstitute.org/cancer/cga/absolute) tool. For extracting copy number state per tumor sample, I used the script **Wrapper_CNV_TCGA.py**, which calls the script **Obtain_CNV_TCGA.py**.

To get the overlaps between muation and copy number features for each sample, I executed the script **intersect_SNV_CNV**, which call the **bedtools intersect** function.

